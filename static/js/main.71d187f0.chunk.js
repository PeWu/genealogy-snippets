(this["webpackJsonpgenealogy-snippets"]=this["webpackJsonpgenealogy-snippets"]||[]).push([[0],{81:function(e,n,t){"use strict";t.r(n);var r=t(79),s=t(5),i=t(50),o=t(102),c=t(30),l=t(0),a=(t(94),t(4));function d(e){localStorage.setItem("list",JSON.stringify(e))}function p(){return JSON.parse(localStorage.getItem("list")||"[]")}function j(e){var n;const t=e.names[0].nameForms[0];return t.fullText?t.fullText:null===(n=t.parts)||void 0===n?void 0:n.map((e=>e.value)).join(" ")}function u(e){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("a",{href:"#",children:j(e.person)||"[unknown]"}),","," "]})}function h(e){var n,t;return Object(a.jsxs)("p",{children:[Object(a.jsxs)("b",{children:[e.fact.type.replace(/.*\//g,"").replace(/([A-Z])/g," $1").replace(/^ /,""),":"," "]}),[e.fact.value,null===(n=e.fact.date)||void 0===n?void 0:n.original,null===(t=e.fact.place)||void 0===t?void 0:t.original].filter((e=>!!e)).join("; ")]})}function b(e){var n,t,r,s,o,c;return Object(a.jsxs)(i.a,{style:{width:500},children:[Object(a.jsx)(i.a.Content,{header:j(e.entry.person)||"[unknown]",style:{width:500}}),Object(a.jsx)(i.a.Content,{children:null===(n=e.entry.person.facts)||void 0===n?void 0:n.map((e=>Object(a.jsx)(h,{fact:e})))}),Object(a.jsxs)(i.a.Content,{children:[e.entry.parents?Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Parents: "}),null===(t=e.entry.parents)||void 0===t?void 0:t.map((e=>Object(a.jsx)(u,{person:e})))]}):null,e.entry.spouses?Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Spouses: "}),null===(r=e.entry.spouses)||void 0===r?void 0:r.map((e=>Object(a.jsx)(u,{person:e})))]}):null,e.entry.children?Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Children: "}),null===(s=e.entry.children)||void 0===s?void 0:s.map((e=>Object(a.jsx)(u,{person:e})))]}):null,e.entry.siblings?Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"Siblings: "}),null===(o=e.entry.siblings)||void 0===o?void 0:o.map((e=>Object(a.jsx)(u,{person:e})))]}):null]}),Object(a.jsx)(i.a.Content,{extra:!0,children:Object(a.jsxs)("a",{href:e.entry.page.url,children:[Object(a.jsx)("img",{src:e.entry.page.favicon,style:{width:16,height:16,marginRight:5}}),(c=e.entry.page.url,c.replace(/.*:\/\/(www\.)?([^/]*)\/.*/,"$2"))]})})]})}function g(e,n,t){const r=e.get(n)||[];r.push(t),e.set(n,r)}function f(e){var n,t,r;const s=new Map,i=new Map,o=new Map;null===(n=e.entry.data.relationships)||void 0===n||n.forEach((e=>{const n=e.person1.resource.substring(1),t=e.person2.resource.substring(1);"http://gedcomx.org/Couple"===e.type?(g(o,n,t),g(o,t,n)):"http://gedcomx.org/ParentChild"===e.type&&(g(s,n,t),g(i,t,n))}));const c=new Map;s.forEach((e=>e.forEach((n=>e.forEach((e=>{n!==e&&g(c,n,e)}))))));const l=new Map;c.forEach(((e,n)=>l.set(n,Array.from(new Set(e)))));const d=new Set,p=[],j=new Map;return null===(t=e.entry.data.persons)||void 0===t||t.forEach((e=>j.set(e.id,e))),null===(r=e.entry.data.persons)||void 0===r||r.forEach((n=>{var t,r,c,a,u,h,b,g;if(d.has(n.id))return;const f={page:e.entry.page,person:n,children:null===(t=s.get(n.id))||void 0===t?void 0:t.map((e=>j.get(e))).filter((e=>!!e)),parents:null===(r=i.get(n.id))||void 0===r?void 0:r.map((e=>j.get(e))).filter((e=>!!e)),spouses:null===(c=o.get(n.id))||void 0===c?void 0:c.map((e=>j.get(e))).filter((e=>!!e)),siblings:null===(a=l.get(n.id))||void 0===a?void 0:a.map((e=>j.get(e))).filter((e=>!!e))};null===(u=f.children)||void 0===u||u.forEach((e=>d.add(e.id))),null===(h=f.parents)||void 0===h||h.forEach((e=>d.add(e.id))),null===(b=f.spouses)||void 0===b||b.forEach((e=>d.add(e.id))),null===(g=f.siblings)||void 0===g||g.forEach((e=>d.add(e.id))),d.add(n.id),p.push(f)})),Object(a.jsx)(a.Fragment,{children:p.map((e=>Object(a.jsx)(b,{entry:e},e.person.id)))})}function v(){const[e,n]=Object(l.useState)([]);function t(e){"list"===e.key&&n(p())}return Object(l.useEffect)((()=>n(p())),[]),Object(l.useEffect)((()=>(window.addEventListener("storage",t),()=>window.removeEventListener("storage",t))),[t]),console.log("#B"),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h1",{children:"Genealogy Snippets"}),Object(a.jsx)(o.a,{color:"red",onClick:function(){d([]),n([])},children:"Clear all"}),e.map((e=>Object(a.jsx)(f,{entry:e},e.page.url)))]})}function x(){function e(e){const n=p(),t=n.map((e=>e.page.url));let r=!1;for(const s of e.data.data)t.includes(s.page.url)||(n.push(s),r=!0);d(n),window.parent.postMessage({response:r?"added":"not_added"},"*")}return Object(l.useEffect)((()=>(window.addEventListener("message",e),()=>window.removeEventListener("message",e))),[]),Object(a.jsx)("h1",{children:"Extension iframe"})}console.log("#A"),Object(c.render)(Object(a.jsx)(r.a,{children:Object(a.jsxs)(s.c,{children:[Object(a.jsx)(s.a,{path:"/",element:Object(a.jsx)(v,{})}),Object(a.jsx)(s.a,{path:"extension-iframe",element:Object(a.jsx)(x,{})})]})}),document.querySelector("#root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.71d187f0.chunk.js.map